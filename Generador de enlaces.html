<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Generador de lista HTML</title>
</head>
<body style="background:#111; color:white; font-family:sans-serif; padding:20px;">

<h2>Generar listado de capítulos</h2>
<textarea id="inputLinks" style="width:100%; height:200px; background:#222; color:#0f0; padding:10px;"></textarea>
<br><br>
<button onclick="generar()">Generar HTML</button>
<h3>Resultado:</h3>
<pre id="output" style="background:#222; color:#0ff; padding:10px; white-space:pre-wrap;"></pre>

<script>
function generar() {
    let texto = document.getElementById("inputLinks").value.trim();
    if (!texto) return;

    let enlaces = texto.split(/\s+/)
        .map(l => l.replace("/d/", "/e/")); // Convertir /d/ a /e/

    // Ordenar por número de capítulo si existe
    enlaces.sort((a, b) => {
        let numA = parseInt(a.match(/Cap.tulo_(\d+)/i)?.[1] || 0);
        let numB = parseInt(b.match(/Cap.tulo_(\d+)/i)?.[1] || 0);
        return numA - numB;
    });

    let resultado = enlaces.map(link => {
        // Obtener el texto después del último "/"
        let rawName = decodeURIComponent(link.split("/").pop());

        // Limpiar: quitar "_", "__", "-" y reemplazar por espacios
        let nombreLimpio = rawName.replace(/[_]+/g, " ").replace(/-/g, " ");

        // Eliminar datos técnicos como resoluciones, fps y codecs
        nombreLimpio = nombreLimpio.replace(/\b(\d{3,4}p|\d{2,3}fps|H264|VP9|AAC|128kbit)\b/gi, "").trim();

        // Reemplazar "Cap tulo" por "Capítulo"
        nombreLimpio = nombreLimpio.replace(/Cap tulo/gi, "Capítulo");

        return `<div class="link-item"><span class="check">✔</span><a href="${link}" target="_blank">${nombreLimpio}</a></div>`;
    }).join("\n");

    document.getElementById("output").textContent = resultado;
}
</script>

</body>
</html>
